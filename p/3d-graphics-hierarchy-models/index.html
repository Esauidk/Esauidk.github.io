<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="My notes on Hierarchal Models"><title>3D Graphics: Hierarchy Models</title><link rel=canonical href=/p/3d-graphics-hierarchy-models/><link rel=stylesheet href=/scss/style.min.18145888f21de6cb02d8cb0891be8240096206785da14eda35f6c23c239b966a.css><meta property="og:title" content="3D Graphics: Hierarchy Models"><meta property="og:description" content="My notes on Hierarchal Models"><meta property="og:url" content="/p/3d-graphics-hierarchy-models/"><meta property="og:site_name" content="Esau's Page"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2022-10-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-20T00:00:00+00:00"><meta property="og:image" content="/p/3d-graphics-hierarchy-models/coordinateFrames.png"><meta name=twitter:title content="3D Graphics: Hierarchy Models"><meta name=twitter:description content="My notes on Hierarchal Models"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/p/3d-graphics-hierarchy-models/coordinateFrames.png"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/pfpAvatar_hub44e2d825aca343e2892b71309d0a58f_25815_300x0_resize_q75_box.jpg width=300 height=302 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ðŸ’»</span></figure><div class=site-meta><h1 class=site-name><a href=/>Esau's Page</a></h1><h2 class=site-description>A collection of my work and things I've explored</h2></div></header><ol class=social-menu><li><a href=https://github.com/Esauidk target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/3d-graphics-hierarchy-models/><img src=/p/3d-graphics-hierarchy-models/coordinateFrames_hu501f4754882fa586b38eda48d2318a36_128655_800x0_resize_box_3.png srcset="/p/3d-graphics-hierarchy-models/coordinateFrames_hu501f4754882fa586b38eda48d2318a36_128655_800x0_resize_box_3.png 800w, /p/3d-graphics-hierarchy-models/coordinateFrames_hu501f4754882fa586b38eda48d2318a36_128655_1600x0_resize_box_3.png 1600w" width=800 height=1214 loading=lazy alt="Featured image of post 3D Graphics: Hierarchy Models"></a></div><div class=article-details><header class=article-category><a href=/categories/graphics/>Graphics</a>
<a href=/categories/math/>Math</a>
<a href=/categories/3d-models/>3D Models</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/3d-graphics-hierarchy-models/>3D Graphics: Hierarchy Models</a></h2><h3 class=article-subtitle>My notes on Hierarchal Models</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 20, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h2 id=matrix-transformation>Matrix Transformation</h2><p>The reason we keep things like translations as a matrix transformation instead of a simple collumn addition is for <strong>EFFICIENCY</strong>.</p><p>If we wanted to do multiple transformations on an objects.</p><p>$$(M_N * &mldr; * M_1) * P $$</p><p>is easier than</p><p>$$(M_2 * ((M_1 * P ) + T_1) + T_2)$$</p><p>We can calculate the overall matrix onces instead of doing multiple computations for multiple points</p><h3 id=types-of-transformation>Types of transformation</h3><p>$$T(x,y,z) = Translation$$
$$S(x,y,z) = Scaling$$
$$Rx(theta) = \text{Rotation over x-axis}$$
$$Ry(theta) = \text{Rotation over y-axis}$$
$$Rz(theta) = \text{Rotation over z-axis}$$</p><h3 id=example-of-transformation>Example of transformation</h3><p>Let&rsquo;s say we want to rotate an object Ï´ on a 2D plane with a point P as it&rsquo;s rotation pivot:</p><ol><li>You want to first translate the object to have point P of the object be at the origin (anything at the origin will not be affected during scaling, translation, or rotation)<ol><li>$$T(-p.x,-p.y,-p.z) = P $$</li></ol></li><li>Next you want to do a rotation around the z-axis (since we are in 2D)<ol><li>$$Rz(Ï´) * T(-p.x, -p.y, -p.z) = P$$</li></ol></li><li>Finally you want to move the object back to its original position<ol><li>$$T(p.x, p.y, p.z) * Rz(Ï´) * T(-p.x, -p.y, -p.z) = P$$</li></ol></li></ol><p><em>Note: Matrix operations go right to left, you need to order the matricies in the order of the transformations correctly</em></p><h2 id=hierachical-models>Hierachical Models</h2><p>With most models, we want certain objects to move similar to joints, where they move if a parent object moves. This is a form called <strong>Hierachical modeling</strong></p><p>You can view it like this:</p><ul><li>World<ul><li>Body<ul><li>Arms<ul><li>Hands<ul><li>Fingers</li></ul></li></ul></li><li>Head<ul><li>Ears</li><li>Eyes</li></ul></li></ul></li></ul></li></ul><p>You can view this as a tree of different matrix transformations</p><h3 id=coordinate-frames>Coordinate Frames</h3><p>You can imagine a coordinate frame as a screenshot of the coordinate system/unit vectors transposed and rotated in some fashion.</p><p>In a hierachical system, each parent-child relationship comes with a coordinate frame that dictates the world view of the particular object</p><p><img src=/p/3d-graphics-hierarchy-models/coordinateFrames.png width=332 height=504 srcset="/p/3d-graphics-hierarchy-models/coordinateFrames_hu501f4754882fa586b38eda48d2318a36_128655_480x0_resize_box_3.png 480w, /p/3d-graphics-hierarchy-models/coordinateFrames_hu501f4754882fa586b38eda48d2318a36_128655_1024x0_resize_box_3.png 1024w" loading=lazy alt=frames class=gallery-image data-flex-grow=65 data-flex-basis=158px></p><p>In a hiearchy, a coordinate frame is made up from the previous coordinate frames from the parents above.</p><p>In the above example:
$$C_0 = T_0$$
$$C_1 = T_1 * R_{x_1}(\theta) * C_0$$
$$C_2 = T_2 * R_{x_2}(\theta) * C_1$$</p><p>Each object uses their own coordinate frame to determine the position of their pixels</p><p>$$\text{Blue} = C_0 * T * S$$
$$\text{Red} = C_1 * T * S$$
$$\text{Green} = C_2 * T * S$$</p><p>With these, if a parents moves in someway, the children will also be affected by them.</p><p>Another way to view the relationships is like this:
<img src=/p/3d-graphics-hierarchy-models/hierarchyTree.png width=658 height=766 srcset="/p/3d-graphics-hierarchy-models/hierarchyTree_hu379017cd298dd767776d8bc8dfe8c0eb_70060_480x0_resize_box_3.png 480w, /p/3d-graphics-hierarchy-models/hierarchyTree_hu379017cd298dd767776d8bc8dfe8c0eb_70060_1024x0_resize_box_3.png 1024w" loading=lazy alt=hierarchyTree class=gallery-image data-flex-grow=85 data-flex-basis=206px></p><p>Now to actually do the math to create these objects, you need to create the overaching matricies multipled with the points of the object.</p><h3 id=generating-the-hierachical-matrix>Generating the hierachical matrix</h3><p>You can view this process as a in-order traversal/DFS using a stack. The stack represents the current overall matrix while you push and pop mini transformation components.</p><ol><li><p>We start with generating the blue block by adding the first coordinate frame into the stack and then adding the block&rsquo;s independent transformations into the stack.
<img src=/p/3d-graphics-hierarchy-models/step1.png width=928 height=848 srcset="/p/3d-graphics-hierarchy-models/step1_hu722deab187dd036be294eea709522527_278667_480x0_resize_box_3.png 480w, /p/3d-graphics-hierarchy-models/step1_hu722deab187dd036be294eea709522527_278667_1024x0_resize_box_3.png 1024w" loading=lazy alt=step1 class=gallery-image data-flex-grow=109 data-flex-basis=262px></p></li><li><p>We then remove the independent transformations of the blue block and add in the additional transformations that make up our next coordinate frame. We then add in the independent transforations of the red block
<img src=/p/3d-graphics-hierarchy-models/step2.png width=940 height=866 srcset="/p/3d-graphics-hierarchy-models/step2_hu5f9bd2ef6a1227cd1b6cc0f6d312f687_91339_480x0_resize_box_3.png 480w, /p/3d-graphics-hierarchy-models/step2_hu5f9bd2ef6a1227cd1b6cc0f6d312f687_91339_1024x0_resize_box_3.png 1024w" loading=lazy alt=step2 class=gallery-image data-flex-grow=108 data-flex-basis=260px></p></li><li><p>We then perform the same steps, remove independent transformations -> create next coordinate frame, add in new independent transformations</p></li></ol><p><img src=/p/3d-graphics-hierarchy-models/finalStep.png width=804 height=744 srcset="/p/3d-graphics-hierarchy-models/finalStep_hu371377724c1064b1fa38f67b56912919_257468_480x0_resize_box_3.png 480w, /p/3d-graphics-hierarchy-models/finalStep_hu371377724c1064b1fa38f67b56912919_257468_1024x0_resize_box_3.png 1024w" loading=lazy alt=step3 class=gallery-image data-flex-grow=108 data-flex-basis=259px></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/3d-graphics-camera-projection/><div class=article-image><img src=/p/3d-graphics-camera-projection/titleImage.e8a86e8ba3cdd4e667bf17ce046ed53c_hudc2430e5b159244bf05090b66d0197bf_103133_250x150_fill_q75_box_smart1.jpeg width=250 height=150 loading=lazy alt="Featured image of post 3D Graphics: Camera Projection" data-hash="md5-6Khui6PN1OZnvxfOBG7VPA=="></div><div class=article-details><h2 class=article-title>3D Graphics: Camera Projection</h2></div></a></article><article class=has-image><a href=/p/3d-graphics-light-reflection-models/><div class=article-image><img src=https://academyofanimatedart.com/wp-content/uploads/2019/03/td-u-CG-lighting-shadows-light-shading-featured.jpg loading=lazy data-key data-hash=https://academyofanimatedart.com/wp-content/uploads/2019/03/td-u-CG-lighting-shadows-light-shading-featured.jpg></div><div class=article-details><h2 class=article-title>3D Graphics: Light Reflection Models</h2></div></a></article><article class=has-image><a href=/p/3d-graphics-accelerated-raytracing/><div class=article-image><img src=https://blogs.nvidia.com/wp-content/uploads/2019/06/rtx-on-off.png loading=lazy data-key data-hash=https://blogs.nvidia.com/wp-content/uploads/2019/06/rtx-on-off.png></div><div class=article-details><h2 class=article-title>3D Graphics: Accelerated RayTracing</h2></div></a></article><article class=has-image><a href=/p/3d-graphics-meshing/><div class=article-image><img src=https://i.stack.imgur.com/Bk826.png loading=lazy data-key data-hash=https://i.stack.imgur.com/Bk826.png></div><div class=article-details><h2 class=article-title>3D Graphics: Meshing</h2></div></a></article><article class=has-image><a href=/p/3d-graphics-raytracing-intro/><div class=article-image><img src=https://i.ytimg.com/vi/Xs0WOuToefw/maxresdefault.jpg loading=lazy data-key data-hash=https://i.ytimg.com/vi/Xs0WOuToefw/maxresdefault.jpg></div><div class=article-details><h2 class=article-title>3D Graphics: RayTracing Intro</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Esau's Page</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.14.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>